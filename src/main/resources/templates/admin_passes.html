<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head>
    <meta charset="UTF-8">
    <title>Admin - Pases</title>
    <style>
        body{margin:0;font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;background:#f5f6fa}
        header{background:#2E7D32;color:#fff;padding:12px 16px}
        .container{max-width:1100px;margin:16px auto;padding:0 16px}
        .card{background:#fff;border-radius:12px;padding:16px;box-shadow:0 8px 24px rgba(0,0,0,.08);margin-bottom:16px}
        table{width:100%;border-collapse:collapse;background:#fff;border-radius:12px;overflow:hidden}
        th,td{padding:10px;border-bottom:1px solid #e9ecef;text-align:left}
        .btn{display:inline-block;padding:8px 10px;border:none;border-radius:8px;background:#2E7D32;color:#fff;cursor:pointer}
        .btn.warn{background:#ffc107;color:#111}
        .btn.danger{background:#dc3545}
        input{padding:8px;border:1px solid #ced4da;border-radius:8px}
        .muted{color:#6c757d}
    </style>
</head>
<body>
<header>
    <div style="display:flex;justify-content:space-between;align-items:center;">
        <div>Administración — Pases</div>
        <nav><a href="/admin/members" style="color:#fff;text-decoration:underline">Volver a miembros</a></nav>
    </div>
</header>
<div class="container">
    <div class="card">
        <h3>Crear nuevo pase</h3>
        <form action="/admin/passes/create" method="post" style="display:flex;gap:8px;align-items:center">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
            <label>ID miembro</label>
            <input name="memberId" placeholder="Ej: 1" required>
            <button class="btn" type="submit">Crear</button>
        </form>
        <p class="muted">El pase se crea con 5 usos activos por defecto.</p>
    </div>

    <div class="card">
        <h3>Listado de pases</h3>
        <table>
            <thead><tr><th>ID</th><th>Miembro</th><th>Código</th><th>Usos</th><th>Activo</th><th>Creado</th><th>Acciones</th></tr></thead>
            <tbody>
            <tr th:each="p : ${passes}">
                <td th:text="${p.id}">1</td>
                <td th:text="${p.member != null ? (p.member.fullName != null ? p.member.fullName : p.member.name) : '-'}">Miembro</td>
                <td th:text="${p.code}">CODE-123</td>
                <td>
                    <form th:action="@{'/admin/passes/' + ${p.id} + '/edit'}" method="post" style="display:flex;gap:6px;align-items:center;margin:0">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                        <input name="usedCount" type="number" min="0" th:value="${p.usedCount}" style="width:80px">
                        /
                        <input name="totalUses" type="number" min="1" th:value="${p.totalUses}" style="width:80px">
                        <label><input type="checkbox" name="active" th:checked="${p.active}"> Activo</label>
                        <button class="btn" type="submit">Guardar</button>
                    </form>
                </td>
                <td th:text="${p.active} ? 'Sí' : 'No'">Sí</td>
                <td th:text="${#temporals.format(p.createdAt, 'dd/MM/yyyy HH:mm')}">01/06/2025</td>
                <td>
                    <form th:action="@{'/admin/passes/' + ${p.id} + '/delete'}" method="post" style="display:inline">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                        <button class="btn danger" type="submit" onclick="return confirm('¿Eliminar pase?')">Eliminar</button>
                    </form>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
</body>
</html>
